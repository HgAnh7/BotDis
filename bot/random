import io
import random
import discord
import requests
from discord.ext import commands

ALLOWED_CHANNELS = [
    1375707188252901376,  # Thay báº±ng ID kÃªnh thá»±c táº¿
    1375707367051886654,  # CÃ³ thá»ƒ thÃªm nhiá»u kÃªnh
]

def register_cosplay(bot: commands.Bot):
    @bot.tree.command(name="cosplay", description="Gá»­i áº£nh cosplay ngáº«u nhiÃªn (only: ğŸ”â”Šnsfw)")
    async def cosplay(interaction: discord.Interaction):
        if interaction.channel_id not in ALLOWED_CHANNELS:
            await interaction.response.send_message(
                "âŒ Lá»‡nh nÃ y chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng trong cÃ¡c kÃªnh Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh!",
                ephemeral=True
            )
            return

        try:
            file_path = "bot/url/cosplay"
            with open(file_path, "r", encoding="utf-8") as file:
                image_urls = [line.strip() for line in file if line.strip()]
            
            selected_image = random.choice(image_urls)
            await interaction.response.send_message(selected_image)

        except Exception as e:
            await interaction.response.send_message(
                f"âŒ Lá»—i: {e}",
                ephemeral=True
            )
